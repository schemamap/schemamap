default:
  @just --list

up:
  docker-compose up -d

down:
  docker-compose down

psql-docker:
  docker exec -it odoo-mydb-1 psql -U odoo odoo_test

psql:
  PGPASSWORD=myodoo psql -h 127.0.0.1 -p 8543 -U odoo odoo_test

docker-ps:
  docker ps

sleep-5:
  # waiting 5 seconds for roles to be created
  sleep 5

schemamap-init:
  # odoo puts the test DB under $DBNAME_test, in our case odoo_test
  # the rest of the connection params are inferred from the docker-compose.yml file
  schemamap init --dbname odoo_test

schemamap-up:
  # create encrypted TCP tunnel to Schemamap.io to expose local Postgres
  schemamap up

schemamap-doctor:
  schemamap doctor

test: up docker-ps sleep-5 schemamap-init schemamap-doctor schemamap-up
